module mnist

declare placeholder [1x784] f32 @x
declare variable [784x10] f32 @W = repeating 0.0
declare variable [1x10] f32 @b = repeating 0.0
declare output [1x10] f32 @y


function @main() {
    section top {
    entry():
        %v0 = get [1x784] f32 @x
        %v1 = matmul [1x784] f32 %v0, [784x10] f32 @W
        %v2 = add [1x10] f32 %v1, [1x10] f32 @b
        %y = tanh [1x10] f32 %v2
        yield [1x10] f32 %y to [1x10] f32 @y
    }
}

