// Float tyep
#type float32

// Input
i: in[2x1]

W1: param[2x2] = random(0.0)
W2: param[2x2] = random(0.0, 1.0)
W3: param[2x2] = random(0.0, 1.0)
b1: param[2x1] = 0.0
b2: param[2x1] = 0.0
b3: param[2x1] = 0.0

// Recurrent block
recurrent t {
    h1[t]: hidden[2x1] = sigmoid(W1 [i[t-1], h2[t-1]] + b1)
    h2[t]: hidden[2x1] = tanh(W2 h1[t] + b2)
}

// Output
o: out[2x1] = softmax(W3 h2 + b3)
